<div class="header-wrapper">
  <header class="site-header" role="banner">
    <div class="page-width">
      <div class="header-inner">
        {%- comment -%} Mobile menu toggle {%- endcomment -%}
        <div class="header-mobile-toggle">
          <button
            type="button"
            class="mobile-nav-toggle"
            aria-controls="MobileNav"
            aria-expanded="false"
            aria-label="Toggle menu">
            <span class="icon-hamburger icon">
              {% render 'icon-hamburger' %}
            </span>
          </button>
        </div>

        {%- comment -%} Site logo {%- endcomment -%}
        <div class="header__logo">
          {% if section.settings.logo != blank %}
            <a href="{{ routes.root_url }}" class="header__logo-link">
              <img
                src="{{ section.settings.logo | img_url: 'master' }}"
                alt="{{ section.settings.logo.alt | default: shop.name | escape }}"
                class="header__logo-image"
                width="{{ section.settings.logo_width }}"
                height="{{ section.settings.logo_height }}"
              >
            </a>
          {% else %}
            <a href="{{ routes.root_url }}" class="header__logo-link">
              <span class="h2">{{ shop.name }}</span>
            </a>
          {% endif %}
        </div>

        {%- comment -%} Desktop navigation {%- endcomment -%}
        <nav class="header-nav">
          <ul class="site-nav list-unstyled">
            {% for link in linklists.main-menu.links %}
              <li class="site-nav__item{% if link.active %} site-nav__item--active{% endif %}">
                {% if link.title == 'Shop' or link.title == 'Products' %}
                  <a href="/collections/featured-products" class="site-nav__link">{{ link.title }}</a>
                {% else %}
                  <a href="{{ link.url }}" class="site-nav__link">{{ link.title }}</a>
                {% endif %}
              </li>
            {% endfor %}
          </ul>
        </nav>

        {%- comment -%} Cart, account and currency selector {%- endcomment -%}
        <div class="header-actions">
          {%- comment -%} Currency selector with conditional visibility on mobile {%- endcomment -%}
          {% if section.settings.show_currency_selector and shop.enabled_currencies.size > 1 %}
            <div class="currency-selector {% if section.settings.hide_currency_selector_on_mobile %}hide-on-mobile{% endif %}">
              {% form 'currency' %}
                <span class="currency-selector__icon">{% render 'icon-globe' %}</span>
                <select name="currency_code" class="currency-selector__select" aria-label="{{ 'localization.currency_selector' | t }}">
                  {% for currency in shop.enabled_currencies %}
                    <option value="{{ currency.iso_code }}" {% if currency.iso_code == cart.currency.iso_code %}selected="selected"{% endif %}>
                      {{ currency.iso_code }} ({{ currency.symbol }})
                    </option>
                  {% endfor %}
                </select>
              {% endform %}
            </div>
          {% endif %}

          <!-- Customer account icon -->
          <a href="{{ routes.account_url }}" class="header-account-link" aria-label="Account">
            {% render 'icon-account' %}
          </a>

          <a href="{{ routes.cart_url }}" class="header-cart-link" aria-label="Cart">
            {% render 'icon-cart' %}
            <span class="cart-count">
              <span data-cart-count>{{ cart.item_count }}</span>
            </span>
          </a>
        </div>
      </div>
    </div>
  </header>

  {% render 'mobile-nav' %}
</div>

<style>
.header-wrapper {
  position: relative;
  background-color: {{ settings.header_background | default: '#2A5E41' }};
  color: {{ settings.header_text | default: '#FFFFFF' }};
  position: sticky;
  top: 0;
  z-index: 100;
}

.site-header {
  padding: 0.5rem 0;
}

.header-inner {
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: relative;
}

/* Logo */
.header-logo {
  display: flex;
  align-items: center;
}

.header-logo-link {
  display: block;
  color: {{ settings.header_text | default: '#FFFFFF' }};
}

.header-logo-image {
  display: block;
  max-height: 80px;
  width: auto;
}

.header-logo-link span {
  font-size: 2rem;
  font-weight: 800;
  font-family: var(--font-heading);
}

.header-logo-link span span {
  color: {{ settings.color_accent | default: '#FFD166' }};
}

/* Navigation */
.header-nav {
  display: none;
}

.site-nav {
  display: flex;
  gap: 2rem;
}

.site-nav__link {
  color: {{ settings.header_text | default: '#FFFFFF' }};
  font-size: 1.1rem;
  text-transform: uppercase;
  letter-spacing: 1px;
  padding: 0.75rem 0.5rem;
  font-weight: 700;
  transition: all 0.3s ease;
  position: relative;
  font-family: var(--font-heading);
}

.site-nav__link::after {
  content: '';
  position: absolute;
  width: 0;
  height: 2px;
  bottom: -2px;
  left: 0;
  background-color: {{ settings.header_text | default: '#FFFFFF' }};
  transition: width 0.3s ease;
}

.site-nav__link:hover {
  color: {{ settings.color_accent | default: '#FFD166' }};
}

.site-nav__link:hover::after {
  width: 100%;
  background-color: {{ settings.color_accent | default: '#FFD166' }};
}

.site-nav__item--active .site-nav__link {
  color: {{ settings.color_accent | default: '#FFD166' }};
  font-weight: 700;
}

.site-nav__item--active .site-nav__link::after {
  width: 100%;
  height: 3px;
  background-color: {{ settings.color_accent | default: '#FFD166' }};
}

/* Actions */
.header-actions {
  display: flex;
  align-items: center;
}

/* Currency selector */
.currency-selector {
  display: flex;
  align-items: center;
  margin-right: 1rem;
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  transition: all 0.2s ease;
  position: relative;
}

.currency-selector:hover {
  background: rgba(255, 255, 255, 0.1);
}

.currency-selector__icon {
  color: {{ settings.header_text | default: '#FFFFFF' }};
  margin-right: 0.3rem;
  font-size: 0.9rem;
}

.currency-selector__select {
  background: transparent;
  border: none;
  font-size: 0.85rem;
  font-weight: 600;
  color: {{ settings.header_text | default: '#FFFFFF' }};
  cursor: pointer;
  padding-right: 1rem;
  appearance: none;
}

.currency-selector__select:focus {
  outline: none;
}

.currency-selector::after {
  content: "â–¼";
  font-size: 0.6rem;
  color: {{ settings.header_text | default: '#FFFFFF' }};
  position: absolute;
  right: 0.5rem;
  top: 50%;
  transform: translateY(-50%);
  pointer-events: none;
}

/* Account link */
.header-account-link {
  color: {{ settings.header_text | default: '#FFFFFF' }};
  font-size: 1.5rem;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 0.5rem;
  margin-right: 0.5rem;
  border-radius: 50%;
  transition: all 0.3s ease;
}

.header-account-link:hover {
  background: rgba(255, 255, 255, 0.2);
  transform: translateY(-2px);
}

/* Cart link */
.header-cart-link {
  color: {{ settings.header_text | default: '#FFFFFF' }};
  font-size: 1.5rem;
  letter-spacing: var(--spacing);
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 0.5rem;
  border-radius: 50%;
  transition: all 0.3s ease;
  position: relative;
}

.header-cart-link:hover {
  background: rgba(255, 255, 255, 0.2);
  transform: translateY(-2px);
}

.cart-count {
  position: absolute;
  top: -8px;
  right: -8px;
  background: {{ settings.color_accent | default: '#FFD166' }};
  width: 22px;
  height: 22px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  font-size: 0.75rem;
  font-weight: 700;
  color: #1a2e37;
}

/* Mobile nav toggle */
.header-mobile-toggle {
  display: block;
}

.mobile-nav-toggle {
  background: transparent;
  border: none;
  color: {{ settings.header_text | default: '#FFFFFF' }};
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  padding: 0.5rem;
  font-size: 1.75rem;
}

.mobile-nav-toggle:hover {
  color: {{ settings.color_accent | default: '#FFD166' }};
}

/* Hide on mobile utility class */
.hide-on-mobile {
  display: none;
}

/* Responsive */
@media screen and (min-width: 992px) {
  .header-mobile-toggle {
    display: none;
  }

  .header-nav {
    display: block;
  }

  .hide-on-mobile {
    display: flex; /* Show currency selector on desktop */
  }

  .header-logo {
    margin-right: 2rem;
  }
}

@media screen and (max-width: 991px) {
  .site-header {
    padding: 0.75rem 0;
  }

  .header-logo {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
  }

  .header-logo-image {
    max-height: 60px;
  }

  .header-actions {
    margin-left: auto;
  }
}

@media screen and (max-width: 767px) {
  .header-logo-image {
    max-height: 50px;
  }
}
</style>